{% extends "layout.html" %}
{% block title %}Schedules | Verdant{% endblock %}

{% block content %}
<section class="space-y-8">
    <header class="space-y-3">
        <h1 class="text-3xl font-semibold text-charcoal">Saved schedules</h1>
        <p class="text-base text-charcoal/70">Manage your favorite planting plans, open them for updates, or tidy up older versions.</p>
    </header>

    {% if schedules %}
    <div class="grid gap-6 sm:grid-cols-2 xl:grid-cols-3">
        {% for s in schedules %}
        {% set updated_at = s.updated_at if s.updated_at is defined else None %}
        <article class="group relative overflow-hidden rounded-3xl border border-verdant/10 bg-white p-6 shadow-lg shadow-verdant/5 transition hover:-translate-y-1 hover:shadow-xl">
            <div class="flex items-start justify-between gap-4">
                <a href="{{ url_for('view_schedule', schedule_id=s.id) }}" class="flex-1">
                    <h2 class="text-xl font-semibold text-charcoal group-hover:text-verdant">{{ s.name }}</h2>
                    <p class="mt-2 text-sm text-charcoal/60">Last updated {{ updated_at.strftime('%b %d, %Y') if updated_at else 'recently' }}</p>
                </a>
                <form method="POST" action="{{ url_for('toggle_favorite', schedule_id=s.id) }}">
                    <button class="favorite-toggle {{ 'is-favorite' if s.is_favorite else '' }}" title="Toggle favorite" aria-label="Toggle favorite for {{ s.name }}" type="submit">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6">
                            <path d="M11.48 3.499a.75.75 0 0 1 1.04 0l1.952 1.89c.143.138.335.214.533.214l2.705-.002c.72 0 1.029.925.48 1.374l-2.09 1.7a.75.75 0 0 0-.252.828l.82 2.637c.22.708-.582 1.284-1.184.857l-2.245-1.568a.75.75 0 0 0-.862 0l-2.245 1.568c-.602.427-1.404-.149-1.184-.857l.82-2.637a.75.75 0 0 0-.252-.828l-2.09-1.7c-.55-.449-.24-1.374.48-1.374l2.705.002c.198 0 .39-.076.533-.214l1.952-1.89Z" />
                        </svg>
                    </button>
                </form>
            </div>
            <div class="mt-4 flex items-center justify-between gap-3 text-sm text-charcoal/70">
                <span class="inline-flex items-center gap-2 rounded-full bg-verdant/10 px-3 py-1 text-xs font-medium text-verdant">
                    {% if s.is_favorite %}
                        Favorite
                    {% else %}
                        Schedule
                    {% endif %}
                </span>
                <form method="POST" action="{{ url_for('delete_schedule', schedule_id=s.id) }}" class="inline" data-confirm="Are you sure you want to delete this schedule?">
                    <button class="delete-button" title="Delete schedule" aria-label="Delete {{ s.name }}" type="submit">Delete</button>
                </form>
            </div>
        </article>
        {% endfor %}
    </div>
    {% else %}
    <div class="rounded-3xl border border-verdant/10 bg-white p-8 text-center shadow-sm">
        <h2 class="text-xl font-semibold text-charcoal">No schedules yet</h2>
        <p class="mt-2 text-sm text-charcoal/70">Generate your first plan to see it appear here.</p>
        <a href="{{ url_for('generate_schedule_view') }}" class="mt-6 inline-flex items-center justify-center rounded-full bg-verdant px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-verdant/30 transition hover:-translate-y-0.5 hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-verdant">Generate schedule</a>
    </div>
    {% endif %}
</section>
{% endblock %}
